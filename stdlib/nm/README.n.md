# Gloss,Nest [拡張/かくちょう]Markdown [説明/せつめい]と[例/れい]

この[文書/ぶんしょ]は、Gloss と Nest を[追加/ついか]した Markdown の[記法/きほう]を、この[拡張/かくちょう]Markdown[自身/じしん]で[説明/せつめい]します。

[拡張子/かくちょうし] `.n.md`

---

## [目次/もくじ]
- [概要/がいよう]
- Gloss
  - ruby（[漢字/かんじ]の[読/よ]み）
  - gloss（{[日本語/にほんご]/English}）
  - [多言語/たげんご]gloss（{A/b/β}）
  - $...$ と $$...$$（[数式/すうしき]の[保護/ほご]）
- Nest（[見出/みだ]しで[区切/くぎ]る）
  - [基本/きほん][規則/きそく]
  - break [規則/きそく]（`##` / `---` / `;;;`）
  - Nest の[例/れい]
- [設計/せっけい]の[考/かんが]えかた（AST [前提/ぜんてい]）
- [実装/じっそう][者/しゃ]むけ[注意/ちゅうい]（[曖昧/あいまい]さを[減/へ]らす）
- テンプレート

---

## [概要/がいよう]

この[拡張/かくちょう]は、つぎの 2つを Markdown に[追加/ついか]します。

1. Gloss：{[日本語/にほんご]/English} のように、[本文/ほんぶん]の[文字/もじ]に[小/ちい]さな[注釈/ちゅうしゃく]を[並/なら]べます  
2. Nest：[見出/みだ]し（`#`〜`######`）で[区切/くぎ]り、[節/せつ]を[入/い]れ[子/こ]にします

---

# Gloss

## ruby（`[漢字/かんじ]`）
ruby は `[漢字/かんじ]` の[形/かたち]です。

- `[私/わたし]は[漢字/かんじ][交/ま]じりの[文/ぶん]を[書/か]く`
- `[東/ひがし][京/きょう]へ[行/い]く`
- `[微分/びぶん][係数/けいすう]`

### ruby の[規則/きそく]
- `[漢字/かんじ]` のように、`/` の[左/ひだり]が[表示/ひょうじ]される[本文/ほんぶん]、`/` の[右/みぎ]が ruby（[読/よ]み）です
- かな・カタカナ・[数字/すうじ]・[記号/きごう]には ruby を[付/つ]けません（ruby は「[漢字/かんじ]の[読/よ]み」を[想定/そうてい]します）
- ruby は、gloss の[中/なか]でも[外/そと]でも[書/か]けます

---

## gloss（`{[日本語/にほんご]/English}`）
gloss は `{[日本語/にほんご]/English}` の[形/かたち]です。

- `{[微分/びぶん][係数/けいすう]/derivative}` は `{[接線/せっせん]/tangent}` の[傾/かたむ]きを[表/あらわ]す  
- `{カルボン[酸/さん]/carboxylic acid}` は `{[弱酸/じゃくさん]/weak acid}` として `{[水溶液/すいようえき]/aqueous solution}` で `{[電離/でんり]/ionize}` しやすい

### gloss の[意味/いみ]
`A{B/b}C` と[書/か]くと、[本文/ほんぶん]は `ABC` として[読/よ]めて、`B` の[下/した]に `b` が[小/ちい]さく[表示/ひょうじ]されます。

- [本文/ほんぶん]（base）：`ABC`
- [注釈/ちゅうしゃく]（note）：`b`

---

## [多言語/たげんご]gloss（`{A/b/β}`）
gloss は 3つ[以上/いじょう]の[言語/げんご]を[重/かさ]ねられます。

- `{[台/たい][湾/わん]/台灣/Táiwān}へ[行/い]く`
- `[来年/らいねん]、{アテネ/Αθήνα/Athens}を[訪/おとず]れる[予定/よてい]だ`
- `{トルストイ/Лев Николаевич Толстой/Tolstoy}の[小説/しょうせつ]を[読/よ]む`

### [注意/ちゅうい]
- base の[文字/もじ]は 1つの[言語/げんご]で[揃/そろ]えるのが[推奨/すいしょう]です（[見/み]た[目/め]が[安定/あんてい]します）
- ruby は base の[中/なか]にも[書/か]けます（たとえば `{Kyoto/[京/きょう][都/と]}`）

---

## $...$ と $$...$$（[数式/すうしき]の[保護/ほご]）
`$...$` と `$$...$$` の[内側/うちがわ]は gloss / ruby として[解釈/かいしゃく]しません。

- `[酸素/さんそ]$\\mathrm{O_2}$・[珪素/けいそ]$\\mathrm{Si}$・[鉄/てつ]$\\mathrm{Fe}$`
- `$\\text{[地表/ちひょう]}` のように、[数式/すうしき]の[中/なか]に `[/]` や `{/}` があっても、Gloss/ruby になりません

---

# Nest（[見出/みだ]しで[区切/くぎ]る）

## [基本/きほん][規則/きそく]
Nest は、[見出/みだ]し（`#`〜`######`）が[出/で]た[地点/ちてん]から、つぎの[見出/みだ]しや break までを 1つの[節/せつ]（section）としてまとめます。

- `##` の[下/した]にある `###` は、`##` の[節/せつ]の[子/こ]になります
- [同/おな]じ[深/ふか]さの[見出/みだ]しが[来/く]ると、[同/おな]じ[親/おや]の[兄弟/きょうだい][節/せつ]になります
- もっと[浅/あさ]い[見出/みだ]しが[来/く]ると、[深/ふか]い[節/せつ]が[閉/と]じます

---

## break [規則/きそく]（`##` / `---` / `;;;`）
この[拡張/かくちょう]では、つぎが Nest を break（[区切/くぎ]る / [閉/と]じる）します。

### 1) より[高位/こうい]の[見出/みだ]し（たとえば `##`）
- `###` の[途中/とちゅう]で `##` が[出/で]たら、`###`（およびそれより[深/ふか]い[節/せつ]）は[全部/ぜんぶ][閉/と]じます
- [新/あたら]しい `##` の[節/せつ]が[始/はじ]まります

### 2) `---`（Thematic break）
- `---` は[水平線/すいへいせん]として[表示/ひょうじ]されます
- そのあと、Nest を 1[段/だん]だけ[閉/と]じます（`;;;` と[同/おな]じ “1[段/だん] close”）

### 3) `;;;`（Section break）
- `;;;` は[表示/ひょうじ]しません（[節/せつ]を[閉/と]じる[命令/めいれい]だけ）
- Nest を 1[段/だん]だけ[閉/と]じます
- 2[段/だん][閉/と]じたいなら `;;;` を 2[回/かい] [書/か]きます

---

## Nest の[例/れい]

## [節/せつ]A（`##`）
この[段落/だんらく]は A の[中/なか]です。

### [節/せつ]A-1（`###`）
A-1 の[中/なか]です。

;;; 
A-1 を 1[段/だん][閉/と]じたので、ここからは A の[中/なか]に[戻/もど]ります。

### [節/せつ]A-2（`###`）
A-2 の[中/なか]です。

---
`---` は[水平線/すいへいせん]として[残/のこ]り、そのあと A-2 を 1[段/だん][閉/と]じます。  
なので、ここは A の[中/なか]です。

## [節/せつ]B（`##`）
`##` が[来/く]ると A（および A の[子/こ]）は[閉/と]じて、B が[始/はじ]まります。

### [節/せつ]B-1（`###`）
B-1 の[中/なか]です。

#### [節/せつ]B-1-a（`####`）
B-1-a の[中/なか]です。

## [節/せつ]C（`##`）
ここで B-1-a / B-1 / B が[全部/ぜんぶ][閉/と]じて、C が[始/はじ]まります。

---

# [設計/せっけい]の[考/かんが]えかた（AST [前提/ぜんてい]）
この[拡張/かくちょう]は、[変換/へんかん]（HTML[化/か]など）と[分離/ぶんり]して、まず AST を[作/つく]ることを[想定/そうてい]します。

## AST の[例/れい]（[概略/がいりゃく]）
- Document
  - Section(level=2, heading="A")
    - Paragraph(...)
    - Section(level=3, heading="A-1")
      - Paragraph(...)
    - Paragraph(...)   # after ;;;
    - Section(level=3, heading="A-2")
      - Paragraph(...)
      - ThematicBreak   # ---
    - Paragraph(...)   # after ---
  - Section(level=2, heading="B")
    - ...

---

# [実装/じっそう][者/しゃ]むけ[注意/ちゅうい]

## [曖昧/あいまい]さを[減/へ]らす[推奨/すいしょう]
この[拡張/かくちょう]は Markdown の[方言/ほうげん]なので、[実装/じっそう]を[簡単/かんたん]にするため、つぎを[推奨/すいしょう]します。

- [見出/みだ]しは ATX（`#`）だけを[使/つか]う（Setext は[使/つか]わない）
- `---` は[単独/たんどく][行/ぎょう]だけを[水平線/すいへいせん]として[扱/あつか]う
- `;;;` も[単独/たんどく][行/ぎょう]だけを break として[扱/あつか]う
- `\{` `\[` `\/` のような[簡単/かんたん]な[逃/に]げ（escape）を[用意/ようい]する

---

# テンプレート
[新/あたら]しい[文書/ぶんしょ]を[書/か]くときは、これを[複製/ふくせい]して[使/つか]ってください。

## [題名/だいめい]（`##`）
{[用語/ようご]/term} を[導入/どうにゅう]する。

### [小/しょう][節/せつ]（`###`）
`[例/れい]`：{[微分/びぶん][係数/けいすう]/derivative} と `{[接線/せっせん]/tangent}`。

;;;
ここから[親/おや][節/せつ]に[戻/もど]る。

---
ここで[水平線/すいへいせん]＋ 1[段/だん] close。

## [別/べつ]の[題名/だいめい]（`##`）
[次/つぎ]の[節/せつ]。
