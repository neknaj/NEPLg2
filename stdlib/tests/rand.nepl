#entry test_rand
#indent 4
#import "core/rand/xorshift32" as *
#import "std/test" as *
#import "core/math" as *

fn test_rand <()*>i32> ():
    // Test 1: init non-zero
    let rng0 new_xorshift32 42

    // Test 2: generate multiple values
    let (rng1, v1) xorshift32_next rng0
    let (rng2, v2) xorshift32_next rng1
    let (rng3, v3) xorshift32_next rng2

    // Check values are not 0 (xorshift property)
    // and ideally different (probabilistic)
    assert_ne (eq v1 0) true
    assert_ne (eq v2 0) true
    assert_ne (eq v1 v2) true

    // Test 3: init with 0 should be corrected
    let rng_z new_xorshift32 0
    let (rng_z1, vz1) xorshift32_next rng_z
    assert_ne (eq vz1 0) true

    test_checked "rand tests passed"
    0
