#entry test_rand
#indent 4
#import "core/rand/xorshift32" as *
#import "std/test" as *
#import "core/math" as *
#import "core/field" as *

fn test_rand <()*>i32> ():
    // Test 1: init non-zero
    let rng0 new_xorshift32 42

    // Test 2: generate multiple values
    let rng1 xorshift32_next rng0
    let v1 get rng1 "state"

    let rng2 xorshift32_next rng1
    let v2 get rng2 "state"

    let rng3 xorshift32_next rng2
    let v3 get rng3 "state"

    // and ideally different (probabilistic)
    assert_ne eq v1 0 true
    assert_ne eq v2 0 true
    assert_ne eq v1 v2 true

    // Test 3: init with 0 should be corrected
    let rng_z new_xorshift32 0
    let rng_z1 xorshift32_next rng_z
    let vz1 get rng_z1 "state"
    assert_ne eq vz1 0 true

    test_checked "rand tests passed"
    0
