//: result: tests/result.nepl に関する機能を提供するライブラリ
//:
//: [目的/もくてき]:
//: - このモジュールの公開 API を提供します。
//: - 実装の変更時に最小限の doctest 実行経路を維持します。
//:
//: [注意/ちゅうい]:
//: - 利用時は各関数の「目的」「注意」「計算量」を確認してください。
//:
//: neplg2:test[skip]
//: ```neplg2
//:| #entry main
//:| #target wasi
//: ()
//: ```

#entry main
#indent 4
#target wasi

#import "core/result" as *
#import "core/math" as *
#import "std/test" as *

//: main: 主な用途
//:
//: [目的/もくてき]:
//: - main の主な用途と呼び出し方を示します。
//:
//: [実装/じっそう]:
//: - 定義済み処理をそのまま呼び出す薄いラッパで構成されています。
//:
//: [注意/ちゅうい]:
//: - 引数の値は関数呼び出しで移動するため、再利用時は束縛し直してください。
//:
//: [計算量/けいさんりょう]:
//: - 本体処理に準じます。
fn main <() *> ()> ():
    // Test ok and is_ok
    let r1 <Result<i32,i32>> ok<i32,i32> 5;
    assert is_ok<i32,i32> r1;
    assert_ne true is_err<i32,i32> ok<i32,i32> 5;

    // Test ok with unwrap_or
    let r2 <Result<i32,i32>> ok<i32,i32> 10;
    assert_eq_i32 10 unwrap_or<i32,i32> r2 0;

    // Test multiple ok values
    let r3 <Result<i32,i32>> ok<i32,i32> 42;
    assert is_ok<i32,i32> r3;

    // Test err and is_err
    let e1 <Result<i32,i32>> err<i32,i32> 7;
    assert is_err<i32,i32> e1;
    assert_ne true is_ok<i32,i32> err<i32,i32> 7;

    // Test err with unwrap_or (returns default)
    let e2 <Result<i32,i32>> err<i32,i32> 99;
    assert_eq_i32 9 unwrap_or<i32,i32> e2 9;

    // Test multiple err values
    let e3 <Result<i32,i32>> err<i32,i32> 123;
    assert is_err<i32,i32> e3;
    let e4 <Result<i32,i32>> err<i32,i32> 123;
    assert_eq_i32 50 unwrap_or<i32,i32> e4 50;

    // Test unwrap_ok
    let okv <Result<i32,i32>> ok<i32,i32> 11;
    assert_eq_i32 11 unwrap_ok<i32,i32> okv;

    // Test unwrap_err
    let errv <Result<i32,i32>> err<i32,i32> 7;
    assert_eq_i32 7 unwrap_err<i32,i32> errv

    ()
