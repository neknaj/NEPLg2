<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NEPLg1 Web Playground</title>
    <link rel="stylesheet" href="styles.css">
    <link data-trunk rel="rust" href="../nepl-web/Cargo.toml" data-bindgen-target="web">
    <script type="module" src="main.js"></script>
</head>
<body>
    <header class="page-header">
        <h1>NEPLg1 Web Playground</h1>
        <p class="lead">NEPL のコードをブラウザ上で編集するための試験的なプレイグラウンドです。</p>
    </header>
    <main class="layout">
        <section class="panel instructions">
            <h2>セットアップ</h2>
            <ol>
                <li>レポジトリルートで <code>scripts/fetch_editorsample.sh</code> を実行して、エディタ用リポジトリを <code>web/vendor/editorsample</code> にクローンします。</li>
                <li>Trunk などの静的サーバーで <code>web/index.html</code> を配信します。</li>
            </ol>
            <p class="note">エディタが読み込めない場合は、クローンが成功しているか、配置パスが正しいかを確認してください。</p>
        </section>
        <section class="panel editor-panel">
            <div class="panel-heading">
                <h2>エディタ</h2>
                <span id="editor-status" class="status status-warning">エディタの読み込みを待機中...</span>
            </div>
            <div class="editor-frame-wrapper">
                <iframe id="editor-frame" title="NEPL Editor" src="vendor/editorsample/index.html"></iframe>
                <div id="fallback" class="fallback" hidden>
                    <p>エディタを読み込めませんでした。<code>scripts/fetch_editorsample.sh</code> を実行してから再度開いてください。</p>
                    <textarea id="fallback-editor" aria-label="Fallback editor" spellcheck="false"></textarea>
                </div>
            </div>
        </section>
        <section class="panel terminal-panel">
            <div class="panel-heading">
                <h2>ターミナル</h2>
                <span id="terminal-status" class="status status-warning">WASM を初期化中...</span>
            </div>
            <div class="terminal-controls">
                <div class="terminal-command">
                    <label for="terminal-command">コマンド</label>
                    <input id="terminal-command" type="text" placeholder="run / test / clear / help" autocomplete="off">
                    <div class="terminal-buttons">
                        <button type="button" id="terminal-run">Run</button>
                        <button type="button" id="terminal-test">Test</button>
                        <button type="button" id="terminal-clear">Clear</button>
                    </div>
                </div>
                <div class="terminal-stdin">
                    <label for="terminal-stdin">stdin</label>
                    <textarea id="terminal-stdin" rows="4" placeholder="標準入力をここに入力"></textarea>
                </div>
            </div>
            <pre id="terminal-output" class="terminal-output" aria-live="polite"></pre>
        </section>
        <section class="panel output-panel">
            <h2>メモ</h2>
            <p>ターミナルから <code>run</code> でコード実行、<code>test</code> で stdlib テストを実行できます。実行結果は WASM 上で評価され、標準入出力はこのパネルに表示されます。</p>
        </section>
    </main>
</body>
</html>
